<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Dashboard - Rideshare Tax Tracker</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <h1>Dashboard</h1>

  <!-- Welcome Message -->
  <section>
    <h2 th:text="'Welcome, ' + ${userEmail}">Welcome, User</h2>
  </section>

  <!-- Add Expense Form -->
  <section>
    <h2>Add Expense</h2>
    <form id="expenseForm">
      <input name="category" placeholder="Category (e.g., Fuel)" required />
      <input name="amount" type="number" step="0.01" placeholder="Amount" required />
      <input name="description" placeholder="Description" required />
      <input type="submit" value="Add Expense" />
    </form>
  </section>

  <!-- Expense List -->
  <section>
    <h2>Expenses</h2>
    <ul id="expenseList"></ul>
  </section>

  <!-- Subscription Area -->
  <section>
    <h2>Subscription</h2>
    <div th:if="${premium}">
      <p>You are on a Premium plan.</p>
    </div>
    <div th:unless="${premium}">
      <button onclick="subscribeNow()">Upgrade to Premium</button>
    </div>
  </section>

  <!-- AI Tax Tips -->
  <section>
    <h2>AI Tax Tips</h2>
    <ul id="aiTips"></ul>
    <button onclick="loadAITips()">Show AI Suggestions</button>
  </section>

  <!-- Scripts -->
  <script src="/js/app.js"></script>
  <script>
    function subscribeNow() {
      fetch('/api/subscription/checkout')
        .then(res => res.json())
        .then(data => {
          window.location.href = data.url;
        });
    }

    function loadAITips() {
      fetch('/api/ai/recommendations/1')
        .then(res => res.json())
        .then(tips => {
          const list = document.getElementById('aiTips');
          list.innerHTML = '';
          tips.forEach(tip => {
            const li = document.createElement('li');
            li.textContent = tip;
            list.appendChild(li);
          });
        });
    }
  </script>
</body>
</html>
